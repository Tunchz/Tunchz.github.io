import{q as Ie,T as Pe,L as he,k as Le,i as Ee,o as Re}from"./_plugin-vue2_normalizer-xzsEtbse.js";import{b as Ve,a as pe,c as De}from"./main-CVmQxpd7.js";import{f as qe}from"./defaultLocale-B8TAAL35.js";import{a as me}from"./arc-C_gK823d.js";import{r as $e}from"./range-OtVwhkKS.js";import{s as Z}from"./selectAll-Cx8JdGyI.js";import"./index-BvYcEE5T.js";import"./constant-I5scnKCP.js";import"./math-CBKwitpL.js";function Be(r,e){return e<r?-1:e>r?1:e>=r?0:NaN}function _e(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function Oe(r){return r.length===1&&(r=He(r)),{left:function(e,n,l,o){for(l==null&&(l=0),o==null&&(o=e.length);l<o;){var t=l+o>>>1;r(e[t],n)<0?l=t+1:o=t}return l},right:function(e,n,l,o){for(l==null&&(l=0),o==null&&(o=e.length);l<o;){var t=l+o>>>1;r(e[t],n)>0?o=t:l=t+1}return l}}}function He(r){return function(e,n){return _e(r(e),n)}}Oe(_e);function de(r,e,n){r=+r,e=+e,n=(o=arguments.length)<2?(e=r,r=0,1):o<3?1:+n;for(var l=-1,o=Math.max(0,Math.ceil((e-r)/n))|0,t=new Array(o);++l<o;)t[l]=r+l*n;return t}var ge=Math.cos,ve=Math.sin,be=Math.PI,H=be/2,xe=be*2,ye=Math.max;function Ue(r){return function(e,n){return r(e.source.value+e.target.value,n.source.value+n.target.value)}}function je(){var r=0,e=null,n=null,l=null;function o(t){var a=t.length,s=[],h=de(a),x=[],y=[],A=y.groups=new Array(a),N=new Array(a*a),F,v,_,M,m,b;for(F=0,m=-1;++m<a;){for(v=0,b=-1;++b<a;)v+=t[m][b];s.push(v),x.push(de(a)),F+=v}for(e&&h.sort(function(T,z){return e(s[T],s[z])}),n&&x.forEach(function(T,z){T.sort(function(L,U){return n(t[z][L],t[z][U])})}),F=ye(0,xe-r*a)/F,M=F?r:xe/a,v=0,m=-1;++m<a;){for(_=v,b=-1;++b<a;){var u=h[m],d=x[u][b],p=t[u][d],w=v,g=v+=p*F;N[d*a+u]={index:u,subindex:d,startAngle:w,endAngle:g,value:p}}A[u]={index:u,startAngle:_,endAngle:v,value:s[u]},v+=M}for(m=-1;++m<a;)for(b=m-1;++b<a;){var C=N[b*a+m],S=N[m*a+b];(C.value||S.value)&&y.push(C.value<S.value?{source:S,target:C}:{source:C,target:S})}return l?y.sort(l):y}return o.padAngle=function(t){return arguments.length?(r=ye(0,t),o):r},o.sortGroups=function(t){return arguments.length?(e=t,o):e},o.sortSubgroups=function(t){return arguments.length?(n=t,o):n},o.sortChords=function(t){return arguments.length?(t==null?l=null:(l=Ue(t))._=t,o):l&&l._},o}var Ge=Array.prototype.slice;function Q(r){return function(){return r}}var J=Math.PI,K=2*J,P=1e-6,We=K-P;function ee(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ne(){return new ee}ee.prototype=Ne.prototype={constructor:ee,moveTo:function(r,e){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,e){this._+="L"+(this._x1=+r)+","+(this._y1=+e)},quadraticCurveTo:function(r,e,n,l){this._+="Q"+ +r+","+ +e+","+(this._x1=+n)+","+(this._y1=+l)},bezierCurveTo:function(r,e,n,l,o,t){this._+="C"+ +r+","+ +e+","+ +n+","+ +l+","+(this._x1=+o)+","+(this._y1=+t)},arcTo:function(r,e,n,l,o){r=+r,e=+e,n=+n,l=+l,o=+o;var t=this._x1,a=this._y1,s=n-r,h=l-e,x=t-r,y=a-e,A=x*x+y*y;if(o<0)throw new Error("negative radius: "+o);if(this._x1===null)this._+="M"+(this._x1=r)+","+(this._y1=e);else if(A>P)if(!(Math.abs(y*s-h*x)>P)||!o)this._+="L"+(this._x1=r)+","+(this._y1=e);else{var N=n-t,F=l-a,v=s*s+h*h,_=N*N+F*F,M=Math.sqrt(v),m=Math.sqrt(A),b=o*Math.tan((J-Math.acos((v+A-_)/(2*M*m)))/2),u=b/m,d=b/M;Math.abs(u-1)>P&&(this._+="L"+(r+u*x)+","+(e+u*y)),this._+="A"+o+","+o+",0,0,"+ +(y*N>x*F)+","+(this._x1=r+d*s)+","+(this._y1=e+d*h)}},arc:function(r,e,n,l,o,t){r=+r,e=+e,n=+n,t=!!t;var a=n*Math.cos(l),s=n*Math.sin(l),h=r+a,x=e+s,y=1^t,A=t?l-o:o-l;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+h+","+x:(Math.abs(this._x1-h)>P||Math.abs(this._y1-x)>P)&&(this._+="L"+h+","+x),n&&(A<0&&(A=A%K+K),A>We?this._+="A"+n+","+n+",0,1,"+y+","+(r-a)+","+(e-s)+"A"+n+","+n+",0,1,"+y+","+(this._x1=h)+","+(this._y1=x):A>P&&(this._+="A"+n+","+n+",0,"+ +(A>=J)+","+y+","+(this._x1=r+n*Math.cos(o))+","+(this._y1=e+n*Math.sin(o))))},rect:function(r,e,n,l){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +l+"h"+-n+"Z"},toString:function(){return this._}};function Xe(r){return r.source}function Ye(r){return r.target}function Ze(r){return r.radius}function Qe(r){return r.startAngle}function Je(r){return r.endAngle}function Ae(){var r=Xe,e=Ye,n=Ze,l=Qe,o=Je,t=null;function a(){var s,h=Ge.call(arguments),x=r.apply(this,h),y=e.apply(this,h),A=+n.apply(this,(h[0]=x,h)),N=l.apply(this,h)-H,F=o.apply(this,h)-H,v=A*ge(N),_=A*ve(N),M=+n.apply(this,(h[0]=y,h)),m=l.apply(this,h)-H,b=o.apply(this,h)-H;if(t||(t=s=Ne()),t.moveTo(v,_),t.arc(0,0,A,N,F),(N!==m||F!==b)&&(t.quadraticCurveTo(0,0,M*ge(m),M*ve(m)),t.arc(0,0,M,m,b)),t.quadraticCurveTo(0,0,v,_),t.closePath(),s)return t=null,s+""||null}return a.radius=function(s){return arguments.length?(n=typeof s=="function"?s:Q(+s),a):n},a.startAngle=function(s){return arguments.length?(l=typeof s=="function"?s:Q(+s),a):l},a.endAngle=function(s){return arguments.length?(o=typeof s=="function"?s:Q(+s),a):o},a.source=function(s){return arguments.length?(r=s,a):r},a.target=function(s){return arguments.length?(e=s,a):e},a.context=function(s){return arguments.length?(t=s??null,a):t},a}function st(r,e,n){const l=e[0],o=e[1];let t=new Set,a=[],s=new Map,h=[],x=0,y=0;function A(u,d){var p,w,g;return p=u[0].value.toUpperCase(),w=d[0].value.toUpperCase(),p<w?g=-1:p>w?g=1:g=0,g===0&&(p=u[1].value.toUpperCase(),w=d[1].value.toUpperCase(),p<w?g=-1:p>w?g=1:g=0),g}let N=r.sort(A);const F=new Set(N.map(u=>u[l].value)),v=new Set(N.map(u=>u[o].value));N.forEach((u,d)=>{t.add(u[l].formattedValue),t.add(u[o].formattedValue)}),a=Array.from(t);let _=[];N.forEach((u,d)=>{let p=u[l].formattedValue,w=u[o].formattedValue,g=Ie(u,n);g>x&&(x=g),g<y&&(y=g),s.get(p)?(_=s.get(p),_.push([p,w,g]),s.set(p,_)):_=s.set(p,[[p,w,g]])});let M=new Set;for(let u in a)for(let d in a)M.add(a[u]+"||"+a[d]);M=Array.from(M);for(let u in M){let d=M[u].split("||"),p=d[0],w=d[1];if(!s.get(p))_=s.set(p,[[p,w,0]]);else{_=s.get(p);let g=!1;for(let C in _)if(_[C][1]===w){g=!0;break}if(!g){let C=0;for(let S in _)_[S][1]<w&&C++;_.splice(C,0,[p,w,0])}}}a.forEach((u,d)=>{let p=[];a.forEach((w,g)=>{let C=u,S=w,T=s.get(C);for(let z in T)if(T[z][1]===S)if(C!==S){T[z],p.push(T[z][2]);break}else{p.push(0);break}}),h.push(p)});let m=[];for(let u in a)m.push(a[u]);function b(u,d){if(u.size!==d.size)return!1;for(let p of u)if(!d.has(p))return!1;return!0}if(!b(new Set(a),new Set(Object.keys(s))))for(let u in h)for(let d in h[u])h[u][d]===0&&h[d][u]!==0&&(h[u][d]=h[d][u]);return{matrixData:h,columnsArr:a,max:x,min:y,fieldNames:m,source:F,target:v}}function ut(r,e,n){let{width:l,height:o,extraSettings:t,measureName:a,isDarkTheme:s,filterDimension:h,measureFormat:x,measureStyle:y,color:A,fontSize:N,dimensionColors:F,memberColors:v,useNewColorFormat:_,enableLegend:M,legendPosition:m,legendRows:b,legendColumns:u,legendPaddingX:d,legendPaddingY:p}=n;v=v.sort((i,f)=>i.fieldName<f.fieldName?-1:i.fieldName>f.fieldName?1:0);class w{constructor(f,c){this.memberColors=f,this.columnsArr=c}getColorByMember(f){for(var c=0;c<this.memberColors.length;c++)for(var k=0;k<this.columnsArr.length;k++)if(this.columnsArr[f]===this.memberColors[c].fieldName)return this.memberColors[c].color}}let g=new w(v,e.columnsArr),C=t[0]||"colorize",S=t[1]||"white",T=t[2]||"1",z=isNaN(parseFloat(t[3]))?4:parseFloat(t[3]),L=isNaN(parseFloat(t[4])/100)?.6:parseFloat(t[4])/100,U=isNaN(parseFloat(t[5])/100)?1:parseFloat(t[5])/100,te=isNaN(parseFloat(t[6]))?1:parseFloat(t[6]),re=isNaN(parseFloat(t[7])/100)?1:parseFloat(t[7])/100,j=isNaN(parseFloat(t[8])/100)?1:parseFloat(t[8])/100,ne=isNaN(parseFloat(t[9]))?.05:parseFloat(t[9]/100),oe=t[10]||(n!=null&&n.textColorAxis?n.textColorAxis:"#666666"),Me=t[11]||(n!=null&&n.textColorLabels?n.textColorLabels:"#666666"),we=t[12]||"none",Ce=t[13]||"#dddddd",$=t[17]||"#4E79A7",B=t[14]?parseInt(t[14]):-25,le=t[15]||"1",ke=parseInt(t[16])||10,Fe=t[18]||"source";x||(x=".1f");let V=qe(x);y&&(V=Re(y));let D=T==="1"?70:10;D=le==="1"&&B>D?B+10:D;let I=Math.min(l,o)/2-D;const E=new Pe("#tooltip",l,o);let ie=5,ae=l-ie,se=o-ie;if(M&&(m.includes("right")&&(ae-=u*100+25),m.includes("bottom")&&(se-=Math.ceil(e.columnsArr.length/u)*18+20)),M){let i=M&&m.includes("right")?ae:10,f=M&&m.includes("bottom")?se:20;if(i+=parseInt(d),f+=parseInt(p),C==="colorize")new he(r,e.columnsArr,s).title(n.legendTitle?n.legendTitle:"Source").text(c=>c).offset(i,f).positioning(m).nrRows(b).nrColumns(u).color(c=>{if(_){for(var k=0;k<v.length;k++)if(v[k].fieldName===c)return v[k].color}else return A(c)}).draw();else if(C==="none"){let c=["All"];new he(r,c,s).title(n.legendTitle?n.legendTitle:"Legend").text(k=>k).offset(i,f).positioning(m).nrRows(b).nrColumns(u).color(k=>$).highlight(X).clearHighlight(Y).draw()}}var G=r.attr("width",l).attr("height",o).append("g").attr("transform",`translate(${l/2},${o/2})`),ue=je().padAngle(ne||.05).sortSubgroups(Be)(e.matrixData);let W=null;G.datum(ue).append("g").selectAll("path").data(function(i){return i}).enter().append("path").attr("class","arc").on("click",ze).classed("focus",i=>i.source.index===W).on("mouseover",(i,f)=>{E.show(n.tooltips.link.content||n.tooltips.link,{SourceName:e.columnsArr[i.source.index].bold(),TargetName:e.columnsArr[i.target.index].bold(),MeasureName:n.measureName,SourceValue:V(i.source.value).bold(),TargetValue:V(i.target.value).bold()}),X(i)}).on("mousemove",()=>{E.updatePosition()}).on("mouseout",()=>{E.hide(),Y()}),G.selectAll(".arc").attr("d",Ae().radius(I-100<10?10:I-100));function ce(i,f){const c=e.columnsArr[i],k=e.columnsArr[f],q=e.source.has(c);return e.source.has(k),Fe==="source"?q?i:f:q?f:i}G.selectAll("path.arc").attr("d",Ae().radius(I-10)).attr("fill",(i,f)=>{const c=ce(i.source.index,i.target.index);return we==="colorize"?g.getColorByMember(c):Ce}).style("fill-opacity",L).style("stroke",(i,f)=>{const c=ce(i.source.index,i.target.index);return S==="colorize"?C==="colorize"?g.getColorByMember(c):$:S==="white"?"#FFF":"#000"}).style("stroke-opacity",re).style("stroke-width",te);let R=r.datum(ue).append("g").attr("transform",`translate(${l/2},${o/2})`).selectAll("g").data(function(i){return i.groups}).enter();if(R.append("g").append("path").attr("class","ring").on("mouseover",(i,f)=>{E.show(n.tooltips.node.content||n.tooltips.node,{Dimension:e.columnsArr[f].bold(),MeasureName:n.measureName,MeasureValue:V(i.value).bold()})}).on("mousemove",()=>{E.updatePosition()}).on("mouseout",()=>{E.hide()}),R.selectAll(".ring").attr("fill",(i,f)=>_?C==="colorize"?g.getColorByMember(f):$:A(e.columnsArr[f])).attr("fill-opacity",U).style("stroke",(i,f)=>S==="colorize"?C==="colorize"?g.getColorByMember(f):$:S==="white"?"#FFF":"#000").style("stroke-opacity",re).style("stroke-width",te).attr("d",me().innerRadius(I-ke).outerRadius(I)),le==="1"){var Se=me().innerRadius(I+B).outerRadius(I+B);R.append("path").attr("id",function(i,f){return"arc"+f}).attr("d",Se),R.append("text").attr("transform","rotate(1)").append("textPath").attr("xlink:href",function(i,f){return"#arc"+f}).text(function(i){return e.columnsArr[i.index]}).attr("fill",Me).attr("opacity",j).style("font-size",N+"rem")}if(T==="1"){let f=function(c,k){var q=(c.endAngle-c.startAngle)/c.value;return $e(0,c.value,k).map(function(fe){return{value:fe,angle:fe*q+c.startAngle}})},i=Math.round((e.max-e.min)/z/100*100);R.selectAll(".group-tick").data(function(c){return f(c,i)}).enter().append("g").attr("transform",function(c){return"rotate("+(c.angle*180/Math.PI-90)+") translate("+I+",0)"}).attr("opacity",j).append("line").attr("x2",6).attr("stroke",oe),R.selectAll(".group-tick-label").data(function(c){return f(c,i)}).enter().filter(function(c){return c.value%i===0}).append("g").attr("transform",function(c){return"rotate("+(c.angle*180/Math.PI-90)+") translate("+I+",0)"}).append("text").attr("x",8).attr("dy",".35em").attr("transform",function(c){return c.angle>Math.PI?"rotate(180) translate(-16)":null}).style("text-anchor",function(c){return c.angle>Math.PI?"end":null}).text(function(c){return V(c.value)}).attr("opacity",j).attr("fill",oe).style("font-size",N+"rem")}function Te(){return W=null,Z("path").classed("focus",!1),Y({unfixHighlight:!0}),De()}function ze(i,f){event.stopPropagation();let c=Le(this),k=c.classed("focus");Te(),!k&&(W=h,c.classed("focus",!0),X(i),Ee()?Ve([{fieldName:n.dimensions[0],value:[e.columnsArr[i.source.index],e.columnsArr[i.target.index]]},{fieldName:n.dimensions[1],value:[e.columnsArr[i.target.index],e.columnsArr[i.source.index]]}]):(pe(n.dimensions[0],[e.columnsArr[i.source.index],e.columnsArr[i.target.index]]),pe(n.dimensions[1],[e.columnsArr[i.source.index],e.columnsArr[i.target.index]])))}let O;function X(i,f,{fixHighlight:c=!1}={}){O||(Z(".arc").style("fill-opacity",k=>k===i?L+.2:L),c&&(O=!0))}function Y({unfixHighlight:i=!1}={}){i&&(O=!1),!O&&Z(".arc").style("fill-opacity",f=>L)}}export{ut as draw,st as parse};
//# sourceMappingURL=chord-diagram-B37i9S6W.js.map
