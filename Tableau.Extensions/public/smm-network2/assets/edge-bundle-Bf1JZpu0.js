import{r as x}from"./lineRadial-D88z6XRS.js";import{B as d}from"./basis-BqPSjl11.js";import{h as y}from"./index-DmxxRM1L.js";import"./line-C5Si6S0i.js";import"./constant-I5scnKCP.js";import"./point-DWREGWZc.js";function*g(t){for(const e of t)yield*e}function v(t){return Array.from(g(t))}function m(t,e){this._basis=new d(t),this._beta=e}m.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,s=t.length-1;if(s>0)for(var l=t[0],i=e[0],r=t[s]-l,o=e[s]-i,f=-1,h;++f<=s;)h=f/s,this._basis.point(this._beta*t[f]+(1-this._beta)*(l+h*r),this._beta*e[f]+(1-this._beta)*(i+h*o));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const _=function t(e){function s(l){return e===1?new d(l):new m(l,e)}return s.beta=function(l){return t(+l)},s}(.85);function b(t,e){return t.parent===e.parent?1:2}function w(t){return t.reduce(M,0)/t.length}function M(t,e){return t+e.x}function $(t){return 1+t.reduce(A,0)}function A(t,e){return Math.max(t,e.y)}function B(t){for(var e;e=t.children;)t=e[0];return t}function I(t){for(var e;e=t.children;)t=e[e.length-1];return t}function P(){var t=b,e=1,s=1,l=!1;function i(r){var o,f=0;r.eachAfter(function(u){var p=u.children;p?(u.x=w(p),u.y=$(p)):(u.x=o?f+=t(u,o):0,u.y=0,o=u)});var h=B(r),n=I(r),c=h.x-t(h,n)/2,a=n.x+t(n,h)/2;return r.eachAfter(l?function(u){u.x=(u.x-r.x)*e,u.y=(r.y-u.y)*s}:function(u){u.x=(u.x-c)/(a-c)*e,u.y=(1-(r.y?u.y/r.y:1))*s})}return i.separation=function(r){return arguments.length?(t=r,i):t},i.size=function(r){return arguments.length?(l=!1,e=+r[0],s=+r[1],i):l?null:[e,s]},i.nodeSize=function(r){return arguments.length?(l=!0,e=+r[0],s=+r[1],i):l?[e,s]:null},i}function E(t,e,s){let l={name:"",children:[]},i,r,o,f,h,n;for(let c of t)o=c[e[0]].formattedValue,r=c[e[1]].formattedValue,h=c[e[2]].formattedValue,f=c[e[3]].formattedValue,f!==r&&(i=l.children,n=i.find(a=>a.name===o),n||(n={name:o,children:[]},i.push(n)),i=n.children,n=i.find(a=>a.id===r),n?n.targets.push(f):(n={id:r,group:o,targets:[f]},i.push(n)));for(let c of t)o=c[e[0]].value,r=c[e[1]].value,h=c[e[2]].value,f=c[e[3]].value,f!==r&&(i=l.children,n=i.find(a=>a.name===h),n||(n={name:h,children:[]},i.push(n)),i=n.children,n=i.find(a=>a.id===f),n?n.targets.push(r):(n={id:f,group:h,targets:[r]},i.push(n)));return l}function G(t,e,s){let{width:l,height:i,textColor:r}=s,o=l/2,f=P().size([2*Math.PI,o-100]),h=x().curve(_.beta(.85)).radius(a=>a.y).angle(a=>a.x);const n=f(y(e)),c=new Map(n.leaves().map(a=>[a.data.id,a]));t.attr("viewBox",`${-l/2} ${-l/2} ${l} ${l-40}`).style("display","block").style("margin","auto").style("font","10px sans-serif"),t.append("g").attr("fill","none").attr("stroke","steelblue").attr("stroke-opacity",.5).selectAll("path").data(v(n.leaves().map(a=>a.data.targets.map(u=>a.path(c.get(u)))))).enter().append("path").style("mix-blend-mode","multiply").attr("d",h),t.append("g").selectAll("text").data(n.leaves()).enter().append("text").style("fill",r).attr("transform",a=>`
        rotate(${a.x*180/Math.PI-90})
        translate(${a.y},0)${a.x>=Math.PI?`
        rotate(180)`:""}
      `).attr("dy","0.31em").attr("x",a=>a.x<Math.PI?3:-3).attr("text-anchor",a=>a.x<Math.PI?"start":"end").text(a=>a.data.id)}export{G as draw,E as parse};
//# sourceMappingURL=edge-bundle-Bf1JZpu0.js.map
