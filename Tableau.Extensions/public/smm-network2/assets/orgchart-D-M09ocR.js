import{l as nt,T as rt,v as P,k as j,o as lt}from"./_plugin-vue2_normalizer-xzsEtbse.js";import{a as ot,c as it}from"./main-CVmQxpd7.js";import{z as ct}from"./zoom-BnyqM2yK.js";import{N as st,h as ut}from"./index-DmxxRM1L.js";import{f as dt}from"./defaultLocale-B8TAAL35.js";import{s as M}from"./selectAll-Cx8JdGyI.js";import{l as ft,a as ht}from"./index-CB7DGV00.js";import"./index-BvYcEE5T.js";import"./index-BNR9-8HJ.js";import"./touch-Dr12ZUMz.js";import"./constant-I5scnKCP.js";import"./point-DWREGWZc.js";function pt(a,e){return a.parent===e.parent?1:2}function T(a){var e=a.children;return e?e[0]:a.t}function A(a){var e=a.children;return e?e[e.length-1]:a.t}function mt(a,e,n){var c=n/(e.i-a.i);e.c-=c,e.s+=n,a.c+=c,e.z+=n,e.m+=n}function xt(a){for(var e=0,n=0,c=a.children,o=c.length,s;--o>=0;)s=c[o],s.z+=e,s.m+=e,e+=s.s+(n+=s.c)}function yt(a,e,n){return a.a.parent===e.parent?a.a:n}function L(a,e){this._=a,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}L.prototype=Object.create(st.prototype);function zt(a){for(var e=new L(a,0),n,c=[e],o,s,p,x;n=c.pop();)if(s=n._.children)for(n.children=new Array(x=s.length),p=x-1;p>=0;--p)c.push(o=n.children[p]=new L(s[p],p)),o.parent=n;return(e.parent=new L(null,0)).children=[e],e}function gt(){var a=pt,e=1,n=1,c=null;function o(t){var f=zt(t);if(f.eachAfter(s),f.parent.m=-f.z,f.eachBefore(p),c)t.eachBefore(y);else{var u=t,r=t,i=t;t.eachBefore(function(d){d.x<u.x&&(u=d),d.x>r.x&&(r=d),d.depth>i.depth&&(i=d)});var h=u===r?1:a(u,r)/2,z=h-u.x,m=e/(r.x+h+z),b=n/(i.depth||1);t.eachBefore(function(d){d.x=(d.x+z)*m,d.y=d.depth*b})}return t}function s(t){var f=t.children,u=t.parent.children,r=t.i?u[t.i-1]:null;if(f){xt(t);var i=(f[0].z+f[f.length-1].z)/2;r?(t.z=r.z+a(t._,r._),t.m=t.z-i):t.z=i}else r&&(t.z=r.z+a(t._,r._));t.parent.A=x(t,r,t.parent.A||u[0])}function p(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function x(t,f,u){if(f){for(var r=t,i=t,h=f,z=r.parent.children[0],m=r.m,b=i.m,d=h.m,w=z.m,g;h=A(h),r=T(r),h&&r;)z=T(z),i=A(i),i.a=t,g=h.z+d-r.z-m+a(h._,r._),g>0&&(mt(yt(h,t,u),t,g),m+=g,b+=g),d+=h.m,m+=r.m,w+=z.m,b+=i.m;h&&!A(i)&&(i.t=h,i.m+=d-b),r&&!T(z)&&(z.t=r,z.m+=m-w,u=t)}return u}function y(t){t.x*=e,t.y=t.depth*n}return o.separation=function(t){return arguments.length?(a=t,o):a},o.size=function(t){return arguments.length?(c=!1,e=+t[0],n=+t[1],o):c?null:[e,n]},o.nodeSize=function(t){return arguments.length?(c=!0,e=+t[0],n=+t[1],o):c?[e,n]:null},o}function Rt(a,e,n,c){let o={name:"",children:[],value:1},s=0;for(let p of a){let x=o.children;for(let y=1;y<=e.length;y++){let t=c.dimensions[y-1],f=e[y-1],u=p[f].formattedValue,r=parseFloat(p[n].value);if(nt(p[f]))continue;let i=x.find(h=>h.name===u);i?(i.value+=r,i.value>s&&(s=i.value)):(y===e.length?i={name:u,dimension:t,value:r}:i={name:u,dimension:t,value:r,children:[]},x.push(i)),x=i.children}}return{data:o,maxValue:s}}let H=null;function Pt(a,e,n){let{color:c,width:o,height:s,measureName:p,measureStyle:x,measureFormat:y,extraSettings:t,fontSize:f,dimensionColors:u,memberColors:r,useNewColorFormat:i,enableLegend:h,legendPosition:z}=n;const m=ut(e.data);let b=e.maxValue,d=t[0]==="1"?1:0,w=t[1]==="0"?"vertical":"horizontal",g=t[2]||"left",E=t[3]||0,N=t[4]||20,k=t[5]||1,W=t[6]||1,I=(t[7]||100)/100,Z=(t[8]||40)/100,q=n.extraSettings[9]||(n!=null&&n.textColor?n.textColor:"#666666");m.dx=N,m.dy=(w==="horizontal"?o:s)/(m.height+1),y||(y=",.0f");let _=dt(y);x&&(_=lt(x));let G=m.descendants(),S={};G.forEach(l=>{S[l.depth]=S[l.depth]?S[l.depth]+1:1}),Math.max(...Object.values(S));const $=gt().nodeSize([m.dx,m.dy])(m),V=new rt("#tooltip",o,s);a.on("click",D);let J=N,K=o,Q=N,U=s;a.call(ct().scaleExtent([0,20]).extent([[J,Q],[K,U]]).on("zoom",X));function X(){R.attr("transform",P.transform)}function Y(){R.attr("transform","translate(0,0) scale(1)")}const F=a.append("g").attr("font-size",f+"rem").attr("transform",w==="horizontal"?`translate(${k<20?20:k-20},${s/2})`:`translate(${o/2},${k<20?20:k-20})`);a.append("g").attr("class","buttons").append("rect").attr("id","Hello").attr("class","buttons").attr("x",o-100).attr("y",5).attr("width",110).attr("height",20).attr("pointer-events","all").attr("opacity",0).on("mouseover",()=>{B(o-20,20,o-32,9)}),a.append("g").attr("class","buttons").append("rect").attr("class","buttons").attr("x",10).attr("y",5).attr("width",110).attr("height",20).attr("pointer-events","all").attr("opacity",0).on("mouseover",()=>{B(20,20,8,9)});function B(l,C,v,tt){a.append("g").attr("class","reset").append("circle").attr("fill","#ffffff").attr("cx",l).attr("cy",C).attr("r",15).attr("stroke","#ddd").attr("fill","#69a3b2").attr("pointer-events","all").attr("fill","#ddd").attr("width",110).attr("height",20).attr("opacity",1).on("click",function(){Y(),j(this).attr("opacity",0),M(".buttonText").remove()}),a.append("g").attr("class","buttonText").append("foreignObject").attr("class","buttonText").attr("x",v).attr("y",tt).attr("width",100).attr("height",20).style("font-color","#ddd").attr("font-weight","bold").attr("pointer-events","none").attr("dy","0.35em").append("xhtml:div").style("font","14px 'Helvetica Neue'").html('<span ><svg style="width:24px;height:24px" viewBox="0 0 24 26"><path fill="currentColor" d="M12 5.5L10 8H14L12 5.5M18 10V14L20.5 12L18 10M6 10L3.5 12L6 14V10M14 16H10L12 18.5L14 16M21 3H3C1.9 3 1 3.9 1 5V19C1 20.1 1.9 21 3 21H21C22.1 21 23 20.1 23 19V5C23 3.9 22.1 3 21 3M21 19H3V5H21V19Z" /></svg> <span> ').attr("pointer-events","none"),et();function et(){setTimeout(at,3e3)}function at(){M(".reset").remove(),M(".buttonText").remove()}}F.append("g").attr("class","links").attr("fill","none").attr("stroke",l=>d===0?i?r[1].color:c(1):"#333").attr("stroke-opacity",Z).attr("stroke-width",1*W).selectAll("path").data($.links()).enter().append("path").attr("d",w==="horizontal"?ft().x(l=>l.y).y(l=>l.x):ht().x(l=>l.x).y(l=>l.y));const O=F.append("g").attr("class","nodes").selectAll("g").data($.descendants()).enter().append("g").attr("transform",l=>w==="horizontal"?`translate(${l.y},${l.x})`:`translate(${l.x},${l.y})`);let R=M(".nodes,.links");O.append("circle").attr("fill",l=>i?d===0?r[0].color:u[0].color:c(C=>C.data.name)).attr("fill-opacity",I).attr("r",l=>1+Math.abs(l.data.value)/b*k).classed("focus",l=>l.data.dimension===H).on("click",bt).on("mouseover",l=>{V.show(n.tooltips.node.content||n.tooltips.node,{DimensionName:l.data.dimension,DimensionValue:l.data.name.bold(),MeasureName:p,MeasureValue:_(l.data.value).bold()})}).on("mousemove",()=>{V.updatePosition()}).on("mouseout",()=>{V.hide()}),O.append("text").attr("dy","0.50em").attr("x",function(){return g==="start"?15:g==="end"?-15:0}).attr("text-anchor",g).attr("transform",`rotate(${E})`).style("fill",q).text(l=>l.data.name).attr("stroke",null)}const bt=async function(e){P.stopPropagation();let n=j(this),c=n.classed("focus");if(await D(),c)return;H=e.data.dimension,n.classed("focus",!0);let o=e;for(;o.parent;)await ot(o.data.dimension,o.data.name),o=o.parent};function D(){return H=null,M(".focus").classed("focus",!1),it()}export{Pt as draw,Rt as parse};
//# sourceMappingURL=orgchart-D-M09ocR.js.map
