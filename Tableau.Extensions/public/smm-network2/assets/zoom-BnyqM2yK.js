import{i as C}from"./index-BNR9-8HJ.js";import{v as p,k as q,G as at}from"./_plugin-vue2_normalizer-xzsEtbse.js";import{m as A,t as R}from"./touch-Dr12ZUMz.js";var O=Math.SQRT2,F=2,j=4,ht=1e-12;function J(n){return((n=Math.exp(n))+1/n)/2}function ct(n){return((n=Math.exp(n))-1/n)/2}function lt(n){return((n=Math.exp(2*n))-1)/(n+1)}function ft(n,i){var e=n[0],r=n[1],s=n[2],l=i[0],f=i[1],w=i[2],D=l-e,M=f-r,v=D*D+M*M,k,I;if(v<ht)I=Math.log(w/s)/O,k=function(x){return[e+x*D,r+x*M,s*Math.exp(O*x*I)]};else{var V=Math.sqrt(v),b=(w*w-s*s+j*v)/(2*s*F*V),c=(w*w-s*s-j*v)/(2*w*F*V),T=Math.log(Math.sqrt(b*b+1)-b),P=Math.log(Math.sqrt(c*c+1)-c);I=(P-T)/O,k=function(x){var B=x*I,y=J(T),G=s/(F*V)*(y*lt(O*B+T)-ct(T));return[e+G*D,r+G*M,s*y/J(O*B+T)]}}return k.duration=I*1e3,k}var mt={value:function(){}};function tt(){for(var n=0,i=arguments.length,e={},r;n<i;++n){if(!(r=arguments[n]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new W(e)}function W(n){this._=n}function pt(n,i){return n.trim().split(/^|\s+/).map(function(e){var r="",s=e.indexOf(".");if(s>=0&&(r=e.slice(s+1),e=e.slice(0,s)),e&&!i.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}W.prototype=tt.prototype={constructor:W,on:function(n,i){var e=this._,r=pt(n+"",e),s,l=-1,f=r.length;if(arguments.length<2){for(;++l<f;)if((s=(n=r[l]).type)&&(s=gt(e[s],n.name)))return s;return}if(i!=null&&typeof i!="function")throw new Error("invalid callback: "+i);for(;++l<f;)if(s=(n=r[l]).type)e[s]=L(e[s],n.name,i);else if(i==null)for(s in e)e[s]=L(e[s],n.name,null);return this},copy:function(){var n={},i=this._;for(var e in i)n[e]=i[e].slice();return new W(n)},call:function(n,i){if((s=arguments.length-2)>0)for(var e=new Array(s),r=0,s,l;r<s;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(l=this._[n],r=0,s=l.length;r<s;++r)l[r].value.apply(i,e)},apply:function(n,i,e){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],s=0,l=r.length;s<l;++s)r[s].value.apply(i,e)}};function gt(n,i){for(var e=0,r=n.length,s;e<r;++e)if((s=n[e]).name===i)return s.value}function L(n,i,e){for(var r=0,s=n.length;r<s;++r)if(n[r].name===i){n[r]=mt,n=n.slice(0,r).concat(n.slice(r+1));break}return e!=null&&n.push({name:i,value:e}),n}function Dt(){p.stopImmediatePropagation()}function Q(){p.preventDefault(),p.stopImmediatePropagation()}function vt(n){var i=n.document.documentElement,e=q(n).on("dragstart.drag",Q,!0);"onselectstart"in i?e.on("selectstart.drag",Q,!0):(i.__noselect=i.style.MozUserSelect,i.style.MozUserSelect="none")}function dt(n,i){var e=n.document.documentElement,r=q(n).on("dragstart.drag",null);i&&(r.on("click.drag",Q,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function K(n){return function(){return n}}function yt(n,i,e){this.target=n,this.type=i,this.transform=e}function E(n,i,e){this.k=n,this.x=i,this.y=e}E.prototype={constructor:E,scale:function(n){return n===1?this:new E(this.k*n,this.x,this.y)},translate:function(n,i){return n===0&i===0?this:new E(this.k,this.x+this.k*n,this.y+this.k*i)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var nt=new E(1,0,0);E.prototype;function H(){p.stopImmediatePropagation()}function U(){p.preventDefault(),p.stopImmediatePropagation()}function wt(){return!p.ctrlKey&&!p.button}function zt(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function N(){return this.__zoom||nt}function _t(){return-p.deltaY*(p.deltaMode===1?.05:p.deltaMode?1:.002)}function Mt(){return navigator.maxTouchPoints||"ontouchstart"in this}function kt(n,i,e){var r=n.invertX(i[0][0])-e[0][0],s=n.invertX(i[1][0])-e[1][0],l=n.invertY(i[0][1])-e[0][1],f=n.invertY(i[1][1])-e[1][1];return n.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),f>l?(l+f)/2:Math.min(0,l)||Math.max(0,f))}function It(){var n=wt,i=zt,e=kt,r=_t,s=Mt,l=[0,1/0],f=[[-1/0,-1/0],[1/0,1/0]],w=250,D=ft,M=tt("start","zoom","end"),v,k,I=500,V=150,b=0;function c(t){t.property("__zoom",N).on("wheel.zoom",et).on("mousedown.zoom",ot).on("dblclick.zoom",it).filter(s).on("touchstart.zoom",rt).on("touchmove.zoom",ut).on("touchend.zoom touchcancel.zoom",st).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.transform=function(t,o,u){var a=t.selection?t.selection():t;a.property("__zoom",N),t!==a?B(t,o,u):a.interrupt().each(function(){y(this,arguments).start().zoom(null,typeof o=="function"?o.apply(this,arguments):o).end()})},c.scaleBy=function(t,o,u){c.scaleTo(t,function(){var a=this.__zoom.k,h=typeof o=="function"?o.apply(this,arguments):o;return a*h},u)},c.scaleTo=function(t,o,u){c.transform(t,function(){var a=i.apply(this,arguments),h=this.__zoom,g=u==null?x(a):typeof u=="function"?u.apply(this,arguments):u,m=h.invert(g),d=typeof o=="function"?o.apply(this,arguments):o;return e(P(T(h,d),g,m),a,f)},u)},c.translateBy=function(t,o,u){c.transform(t,function(){return e(this.__zoom.translate(typeof o=="function"?o.apply(this,arguments):o,typeof u=="function"?u.apply(this,arguments):u),i.apply(this,arguments),f)})},c.translateTo=function(t,o,u,a){c.transform(t,function(){var h=i.apply(this,arguments),g=this.__zoom,m=a==null?x(h):typeof a=="function"?a.apply(this,arguments):a;return e(nt.translate(m[0],m[1]).scale(g.k).translate(typeof o=="function"?-o.apply(this,arguments):-o,typeof u=="function"?-u.apply(this,arguments):-u),h,f)},a)};function T(t,o){return o=Math.max(l[0],Math.min(l[1],o)),o===t.k?t:new E(o,t.x,t.y)}function P(t,o,u){var a=o[0]-u[0]*t.k,h=o[1]-u[1]*t.k;return a===t.x&&h===t.y?t:new E(t.k,a,h)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function B(t,o,u){t.on("start.zoom",function(){y(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){y(this,arguments).end()}).tween("zoom",function(){var a=this,h=arguments,g=y(a,h),m=i.apply(a,h),d=u==null?x(m):typeof u=="function"?u.apply(a,h):u,z=Math.max(m[1][0]-m[0][0],m[1][1]-m[0][1]),S=a.__zoom,Y=typeof o=="function"?o.apply(a,h):o,X=D(S.invert(d).concat(z/S.k),Y.invert(d).concat(z/Y.k));return function(_){if(_===1)_=Y;else{var Z=X(_),$=z/Z[2];_=new E($,d[0]-Z[0]*$,d[1]-Z[1]*$)}g.zoom(null,_)}})}function y(t,o,u){return!u&&t.__zooming||new G(t,o)}function G(t,o){this.that=t,this.args=o,this.active=0,this.extent=i.apply(t,o),this.taps=0}G.prototype={start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,o){return this.mouse&&t!=="mouse"&&(this.mouse[1]=o.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=o.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=o.invert(this.touch1[0])),this.that.__zoom=o,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){at(new yt(c,t,this.that.__zoom),M.apply,M,[t,this.that,this.args])}};function et(){if(!n.apply(this,arguments))return;var t=y(this,arguments),o=this.__zoom,u=Math.max(l[0],Math.min(l[1],o.k*Math.pow(2,r.apply(this,arguments)))),a=A(this);if(t.wheel)(t.mouse[0][0]!==a[0]||t.mouse[0][1]!==a[1])&&(t.mouse[1]=o.invert(t.mouse[0]=a)),clearTimeout(t.wheel);else{if(o.k===u)return;t.mouse=[a,o.invert(a)],C(this),t.start()}U(),t.wheel=setTimeout(h,V),t.zoom("mouse",e(P(T(o,u),t.mouse[0],t.mouse[1]),t.extent,f));function h(){t.wheel=null,t.end()}}function ot(){if(k||!n.apply(this,arguments))return;var t=y(this,arguments,!0),o=q(p.view).on("mousemove.zoom",g,!0).on("mouseup.zoom",m,!0),u=A(this),a=p.clientX,h=p.clientY;vt(p.view),H(),t.mouse=[u,this.__zoom.invert(u)],C(this),t.start();function g(){if(U(),!t.moved){var d=p.clientX-a,z=p.clientY-h;t.moved=d*d+z*z>b}t.zoom("mouse",e(P(t.that.__zoom,t.mouse[0]=A(t.that),t.mouse[1]),t.extent,f))}function m(){o.on("mousemove.zoom mouseup.zoom",null),dt(p.view,t.moved),U(),t.end()}}function it(){if(n.apply(this,arguments)){var t=this.__zoom,o=A(this),u=t.invert(o),a=t.k*(p.shiftKey?.5:2),h=e(P(T(t,a),o,u),i.apply(this,arguments),f);U(),w>0?q(this).transition().duration(w).call(B,h,o):q(this).call(c.transform,h)}}function rt(){if(n.apply(this,arguments)){var t=p.touches,o=t.length,u=y(this,arguments,p.changedTouches.length===o),a,h,g,m;for(H(),h=0;h<o;++h)g=t[h],m=R(this,t,g.identifier),m=[m,this.__zoom.invert(m),g.identifier],u.touch0?!u.touch1&&u.touch0[2]!==m[2]&&(u.touch1=m,u.taps=0):(u.touch0=m,a=!0,u.taps=1+!!v);v&&(v=clearTimeout(v)),a&&(u.taps<2&&(v=setTimeout(function(){v=null},I)),C(this),u.start())}}function ut(){if(this.__zooming){var t=y(this,arguments),o=p.changedTouches,u=o.length,a,h,g,m;for(U(),v&&(v=clearTimeout(v)),t.taps=0,a=0;a<u;++a)h=o[a],g=R(this,o,h.identifier),t.touch0&&t.touch0[2]===h.identifier?t.touch0[0]=g:t.touch1&&t.touch1[2]===h.identifier&&(t.touch1[0]=g);if(h=t.that.__zoom,t.touch1){var d=t.touch0[0],z=t.touch0[1],S=t.touch1[0],Y=t.touch1[1],X=(X=S[0]-d[0])*X+(X=S[1]-d[1])*X,_=(_=Y[0]-z[0])*_+(_=Y[1]-z[1])*_;h=T(h,Math.sqrt(X/_)),g=[(d[0]+S[0])/2,(d[1]+S[1])/2],m=[(z[0]+Y[0])/2,(z[1]+Y[1])/2]}else if(t.touch0)g=t.touch0[0],m=t.touch0[1];else return;t.zoom("touch",e(P(h,g,m),t.extent,f))}}function st(){if(this.__zooming){var t=y(this,arguments),o=p.changedTouches,u=o.length,a,h;for(H(),k&&clearTimeout(k),k=setTimeout(function(){k=null},I),a=0;a<u;++a)h=o[a],t.touch0&&t.touch0[2]===h.identifier?delete t.touch0:t.touch1&&t.touch1[2]===h.identifier&&delete t.touch1;if(t.touch1&&!t.touch0&&(t.touch0=t.touch1,delete t.touch1),t.touch0)t.touch0[1]=this.__zoom.invert(t.touch0[0]);else if(t.end(),t.taps===2){var g=q(this).on("dblclick.zoom");g&&g.apply(this,arguments)}}}return c.wheelDelta=function(t){return arguments.length?(r=typeof t=="function"?t:K(+t),c):r},c.filter=function(t){return arguments.length?(n=typeof t=="function"?t:K(!!t),c):n},c.touchable=function(t){return arguments.length?(s=typeof t=="function"?t:K(!!t),c):s},c.extent=function(t){return arguments.length?(i=typeof t=="function"?t:K([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),c):i},c.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],c):[l[0],l[1]]},c.translateExtent=function(t){return arguments.length?(f[0][0]=+t[0][0],f[1][0]=+t[1][0],f[0][1]=+t[0][1],f[1][1]=+t[1][1],c):[[f[0][0],f[0][1]],[f[1][0],f[1][1]]]},c.constrain=function(t){return arguments.length?(e=t,c):e},c.duration=function(t){return arguments.length?(w=+t,c):w},c.interpolate=function(t){return arguments.length?(D=t,c):D},c.on=function(){var t=M.on.apply(M,arguments);return t===M?c:t},c.clickDistance=function(t){return arguments.length?(b=(t=+t)*t,c):Math.sqrt(b)},c}export{Q as a,vt as d,nt as i,Dt as n,dt as y,It as z};
//# sourceMappingURL=zoom-BnyqM2yK.js.map
