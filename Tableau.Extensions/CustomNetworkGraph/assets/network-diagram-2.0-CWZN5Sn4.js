import{i as Rt,z as jt}from"./zoom-BnyqM2yK.js";import{l as rt,a as Ie,c as qt}from"./main-CVmQxpd7.js";import{q as Ee,T as Wt,i as He,L as Jt,v as R,k as E,o as Ut}from"./_plugin-vue2_normalizer-xzsEtbse.js";import{f as Zt}from"./defaultLocale-B8TAAL35.js";import{c as Y,s as Yt,f as $e,a as Be,b as ze,d as Oe,e as De,g as Xt,h as Qt,i as Kt}from"./manyBody-hrwLCHaU.js";import{l as lt}from"./linear-P-jk5mvR.js";import{s as ot}from"./selectAll-Cx8JdGyI.js";import{l as en}from"./line-C5Si6S0i.js";import{C as tn,a as nn,n as at}from"./cardinalClosed-BJLWxcGN.js";import{e as it}from"./math-CBKwitpL.js";import"./index-BNR9-8HJ.js";import"./touch-Dr12ZUMz.js";import"./index-BvYcEE5T.js";import"./constant-I5scnKCP.js";import"./point-DWREGWZc.js";function ut(t,r,l){var i=t._x1,u=t._y1,f=t._x2,y=t._y2;if(t._l01_a>it){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,m=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/m,u=(u*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/m}if(t._l23_a>it){var N=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,L=3*t._l23_a*(t._l23_a+t._l12_a);f=(f*N+t._x1*t._l23_2a-r*t._l12_2a)/L,y=(y*N+t._y1*t._l23_2a-l*t._l12_2a)/L}t._context.bezierCurveTo(i,u,f,y,t._x2,t._y2)}function ct(t,r){this._context=t,this._alpha=r}ct.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,r){if(t=+t,r=+r,this._point){var l=this._x2-t,i=this._y2-r;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(l*l+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break;case 1:this._point=2;break;case 2:this._point=3;default:ut(this,t,r);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=r}};(function t(r){function l(i){return r?new ct(i,r):new tn(i,0)}return l.alpha=function(i){return t(+i)},l})(.5);function ft(t,r){this._context=t,this._alpha=r}ft.prototype={areaStart:at,areaEnd:at,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,r){if(t=+t,r=+r,this._point){var l=this._x2-t,i=this._y2-r;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(l*l+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=r;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=r);break;case 2:this._point=3,this._x5=t,this._y5=r;break;default:ut(this,t,r);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=r}};const rn=function t(r){function l(i){return r?new ft(i,r):new nn(i,0)}return l.alpha=function(i){return t(+i)},l}(.5);function ye(t){for(var r=-1,l=t.length,i=0,u=0,f,y=t[l-1],a,m=0;++r<l;)f=y,y=t[r],m+=a=f[0]*y[1]-y[0]*f[1],i+=(f[0]+y[0])*a,u+=(f[1]+y[1])*a;return m*=3,[i/m,u/m]}function ln(t,r,l){return(r[0]-t[0])*(l[1]-t[1])-(r[1]-t[1])*(l[0]-t[0])}function on(t,r){return t[0]-r[0]||t[1]-r[1]}function st(t){const r=t.length,l=[0,1];let i=2,u;for(u=2;u<r;++u){for(;i>1&&ln(t[l[i-2]],t[l[i-1]],t[u])<=0;)--i;l[i++]=u}return l.slice(0,i)}function te(t){if((l=t.length)<3)return null;var r,l,i=new Array(l),u=new Array(l);for(r=0;r<l;++r)i[r]=[+t[r][0],+t[r][1],r];for(i.sort(on),r=0;r<l;++r)u[r]=[i[r][0],-i[r][1]];var f=st(i),y=st(u),a=y[0]===f[0],m=y[y.length-1]===f[f.length-1],N=[];for(r=f.length-1;r>=0;--r)N.push(t[i[f[r]][2]]);for(r=+a;r<y.length-m;++r)N.push(t[i[y[r]][2]]);return N}function an(t){var r=Y(.1),l,i,u;typeof t!="function"&&(t=Y(t==null?0:+t));function f(a){for(var m=0,N=l.length,L;m<N;++m)L=l[m],L.vx+=(u[m]-L.x)*i[m]*a}function y(){if(l){var a,m=l.length;for(i=new Array(m),u=new Array(m),a=0;a<m;++a)i[a]=isNaN(u[a]=+t(l[a],a,l))?0:+r(l[a],a,l)}}return f.initialize=function(a){l=a,y()},f.strength=function(a){return arguments.length?(r=typeof a=="function"?a:Y(+a),y(),f):r},f.x=function(a){return arguments.length?(t=typeof a=="function"?a:Y(+a),y(),f):t},f}function sn(t){var r=Y(.1),l,i,u;typeof t!="function"&&(t=Y(t==null?0:+t));function f(a){for(var m=0,N=l.length,L;m<N;++m)L=l[m],L.vy+=(u[m]-L.y)*i[m]*a}function y(){if(l){var a,m=l.length;for(i=new Array(m),u=new Array(m),a=0;a<m;++a)i[a]=isNaN(u[a]=+t(l[a],a,l))?0:+r(l[a],a,l)}}return f.initialize=function(a){l=a,y()},f.strength=function(a){return arguments.length?(r=typeof a=="function"?a:Y(+a),y(),f):r},f.y=function(a){return arguments.length?(t=typeof a=="function"?a:Y(+a),y(),f):t},f}function Mn(t,r,l,i){r.forEach(d=>{});let u=i.dimensions[0],f=i.dimensions[3]||i.dimensions[1],y=i.dimensions[1],a=i.dimensions[4],m=r[0],N=r[1],L=r[2],x=r[3]??r[1],ae=r[4],_=r[5],j=-1/0,T=-1/0,A=r[6],X=0,I={},ie=[];for(let d of t){let w=d[m].formattedValue,J=d[x].formattedValue,q=null;A!=null&&(q=d[A].formattedValue);let $=Ee(d,l);if(Number.isNaN($))throw new Error("The selected measure contains non-numeric values.");J!=="Null"&&(Math.abs($)>j&&(j=Math.abs($)),ie.push({source:w,target:J,value:$,group:q}))}for(let d of t){let w=d[m].formattedValue,J=N!=null?d[N].formattedValue:"noGroup",q="noSymbol",$=null;A!=null&&($=d[A].formattedValue);let U=L!=null?d[L].formattedValue:"noUrl",D=Ee(d,l);if(Math.abs(D)>T&&(T=Math.abs(D)),!I[w]||I[w]===w)I[w]={id:X,type:"source",name:w,group:J,groupId:$,fromValue:D,toValue:0,symbol:q,url:U};else{let W=D+I[w].fromValue;Math.abs(W)>T&&(T=Math.abs(W)),I[w].fromValue=W}X++}for(let d of t){let w=d[x].formattedValue,J=ae!=null?d[ae].formattedValue:"noGroup",q="noSymbol",$=_!=null?d[_].formattedValue:"noUrl",U=Ee(d,l),D=null;if(A!=null&&(D=d[A].formattedValue),Math.abs(U)>T&&(T=Math.abs(U)),w!=="Null"){if(!I[w]||I[w]===w)I[w]={id:X,type:"target",name:w,group:J,groupId:D,fromValue:0,toValue:U,symbol:q,url:$};else{let W=U+I[w].toValue;Math.abs(W)>T&&(T=Math.abs(W)),I[w].toValue=W}X++}}let xe=Object.entries(I).map(d=>({id:d[1].id,type:d[1].type,name:d[1].name,group:d[1].group,groupId:d[1].groupId,symbol:d[1].symbol,url:d[1].url,sourceDim:u,targetDim:f,sourceColorBy:y,targetColorBy:a,groupDim:y,fromValue:d[1].fromValue,toValue:d[1].toValue}));return{links:ie,nodes:xe,maxLinkValue:j,maxNodeValue:T}}let Ge=null;async function Pn(t,r,l){let{color:i,width:u,height:f,measureName:y,measureFormat:a,measureStyle:m,filterDimension:N,fontSize:L,extraSettings:x,isDarkTheme:ae,memberColors:_,useNewColorFormat:j,enableLegend:T,legendPosition:A,legendRows:X,legendColumns:I,legendPaddingX:ie,legendPaddingY:xe}=l;const d=new Wt("#tooltip",u,f);let w=r.maxLinkValue,J=r.maxNodeValue,q=x[0]==="1"?"nodes":"nodesAndLinks",$=!0,U=(x[2]==="0",!1),D=x[3]!=="0",W=x[4]==="1"?"toValue":"fromValue",_e=x[5]||30,be=x[25]||-10,ne=x[7]||2,Fe=x[8]||1,dt=300,Re=(x[10]||100)/100,se=(x[11]||30)/100,re=x[12]||1,ht=(x[13]||100)/100,pt=x[14]||0,ue=x[15]||"selected",ve=(x[16]||20)/10,we=x[17]||"none",ke=x[18]||"none",Ve=x[19]||"circle",je=x[20]||"true",Ce=x[21]/10+1||1.2,Se=x[22]||1,B=x[23]||"highlightOutward",Ne=x[24]||"0",mt=x[26]||"0",gt=x[27]||"#000000",Le=x[28]||(l!=null&&l.linkColor?l.linkColor:"#999999"),le=tableau.extensions,G={},qe=le.environment.mode==="authoring",Z=0,yt=new CustomEvent("restart",{detail:{message:"restart"}});document.getElementById("message")&&document.getElementById("message").remove();let v=document.createElement("div");v.id="message",v.style.position="absolute",v.style.top="20px",v.style.left=u-350+"px",v.style.backgroundColor="#f5f5f5",v.style.border="1px solid #000",v.style.borderRadius="5px",v.style.width="300px",v.style.height="130px",v.style.opacity="0",v.style.zIndex="-1",document.body.appendChild(v);function xt(){if(v.style.opacity="0.8",v.style.zIndex="1",document.getElementById("messageText"))v.style.opacity="0.8";else{let e=document.createElement("h2");e.id="messageText",e.style.textAlign="center",e.style.padding="10px",e.style.fontSize="15px",e.style.wordWrap="break-word",e.innerHTML="This action will clear your local view storage. Do you want to continue? Please note that this action cannot be undone.",v.appendChild(e);let n=document.createElement("button");n.id="yesBtn",n.innerHTML="Yes",n.style.margin="10px",n.style.padding="10px",n.style.position="absolute",n.style.top="60px",n.style.left="50px",n.style.backgroundColor="#ddd",n.style.borderRadius="5px",n.style.border="1px solid #000",n.style.color="#000",n.style.fontSize="12px",n.style.fontWeight="bold",n.style.cursor="pointer",n.addEventListener("click",()=>{v.style.opacity=0,G={},Dt(),l.enableValueStoreSettings&&qe&&Ft(),M.each(function(p){p.fixed=!1,p.fx=null,p.fy=null}),z.alphaTarget(.3).restart()}),v.appendChild(n);let o=document.createElement("button");o.innerHTML="No",o.id="noBtn",o.style.margin="10px",o.style.padding="10px",o.style.position="absolute",o.style.top="60px",o.style.left="170px",o.style.backgroundColor="#ddd",o.style.borderRadius="5px",o.style.border="1px solid #000",o.style.color="#000",o.style.fontSize="12px",o.style.fontWeight="bold",o.style.cursor="pointer",o.addEventListener("click",()=>{v.style.display="none",v.style.opacity=0}),v.appendChild(o)}}t.on("click",et),a||(a=".1f");let Q=Zt(a);m&&(Q=Ut(m));let _t=Yt();function bt(e,n){E(e).html(n)}bt(".oy-menu-btn",'<span ><svg style="width:24px;height:24px" viewBox="0 0 27 20"><path fill="currentColor" d="M12 5.5L10 8H14L12 5.5M18 10V14L20.5 12L18 10M6 10L3.5 12L6 14V10M14 16H10L12 18.5L14 16M21 3H3C1.9 3 1 3.9 1 5V19C1 20.1 1.9 21 3 21H21C22.1 21 23 20.1 23 19V5C23 3.9 22.1 3 21 3M21 19H3V5H21V19Z" /></svg> <span>');let ce=new Set(r.nodes.map(e=>e.groupId)),We=[],vt=[];for(let e=0;e<ce.size;e++)We.push(window.innerWidth*5/ce.size*e+100),vt.push(window.innerHeight*5/ce.size*(e+10));if(l.enableValueStoreParameter&&!l.enableValueStoreSettings&&l.localViewParameter!==void 0){let e=He()?window.tableau.extensions.worksheetContent.worksheet:window.tableau.extensions.dashboardContent.dashboard;const n=Promise.resolve(e.findParameterAsync(l.localViewParameter).then(function(p){return JSON.parse(p.currentValue.value)}));async function o(){try{return await n}catch{}}G=await o()}let Je=5,wt=lt().domain([0,J]).range([10*ne,100*ne]),kt=lt().domain([0,w]).range([.1*Fe,.5*Fe]);var z="";Ne==="0"?(z=$e(r.nodes).force("link",Be(r.links).id(e=>e.name).distance(_e)).force("charge",ze().strength(be)).force("collision",Oe().radius(function(e){return ne*1.4+re*1.4})).force("center",De(u/2,f/2)),z.on("tick",pe)):Ne==="1"?(z=$e(r.nodes).force("link",Be(r.links).id(e=>e.name).distance(_e)).force("charge",ze().strength(be)).force("collision",Oe().radius(function(e){return ne*1.4})).force("center",De(u/2,f/2)).force("x",an(function(e){let n=Array.from(ce).indexOf(e.groupId);return We[n]})),z.on("tick",pe)):Ne==="2"&&(z=$e(r.nodes).force("link",Be(r.links).id(e=>e.name).distance(_e)).force("charge",ze().strength(be)).force("collision",Oe().radius(function(e){return ne*1.4})).force("center",De(u/2,f/2)).force("y",sn().y(function(e){return 0})),z.on("tick",pe));let Ue=t.append("svg:defs"),Ze=u-Je,Ye=f-Je;if(T&&(A==="right"&&(Ze-=I*100+45),A==="bottom"&&(Ye-=X*18+20)),T){let e=T&&A==="right"?Ze:10,n=T&&A==="bottom"?Ye:70;e+=parseInt(ie),n+=parseInt(xe),new Jt(t,_,ae).title(l.legendTitle?l.legendTitle:"Color Legend").text(o=>o.fieldName).offset(e,n).positioning(A).nrRows(X).nrColumns(I).color(o=>{if(j){for(var p=0;p<_.length;p++)if(_[p].fieldName===o)return _[p].color}else return i(o)}).draw()}Ue.selectAll("pattern").data(r.nodes.filter(e=>e.url!=="noUrl")).enter().append("svg:pattern").attr("id",e=>`img${e.name.replace(/\s/g,"").toLowerCase()}`).attr("viewBox",e=>e.type==="source"?we==="none"?"0 0 5 5":"0 0 7.5 7.5":ke==="none"?"0 0 5 5":"0 0 7.5 7.5").attr("width","5").attr("height","5").append("svg:image").attr("xlink:href",e=>e.url).attr("transform",e=>e.type==="source"?we==="none"?"translate(0,0)":"translate(0.25,0.25)":ke==="none"?"translate(0,0)":"translate(0.25,0.25)").attr("width","1").attr("height","1"),D&&Ue.selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",e=>e).attr("viewBox","-10 -5 10 10").attr("refX","-2px").attr("refY",0).attr("markerWidth",5).attr("markerHeight",5).attr("orient","auto-start-reverse").append("svg:path").attr("fill",Le).attr("fill-opacity",se+.3).attr("d","M-10,-5L0,0L-10,5");let O=t.append("g").attr("class","container"),Xe=O.append("g").attr("class","hulls");O.append("g").attr("class","hulls");let K=O.append("g").attr("class","links").selectAll("path").data(r.links).enter().append("path").attr("marker-end","url(#end)").attr("fill","none").attr("stroke",e=>{var o,p;if(q==="nodesAndLinks"){if(j){for(var n=0;n<_.length;n++)if(_[n].fieldName==e.source.group)return _[n].color;return Le}else if((o=e.source)!=null&&o.group)return i((p=e.source)==null?void 0:p.group)}else return Le}).attr("stroke-width",e=>kt(e.value)).on("mouseover",e=>{d.show(l.tooltips.link.content||l.tooltips.link,{SourceName:"<b>"+e.source.name+"</b>",TargetName:e.target.name.bold(),MeasureName:y,MeasureValue:Q(e.value).bold(),FromValue:Q(e.source.fromValue).bold(),ToValue:Q(e.source.targetValue).bold(),SourceGroup:e.source.group,TargetGroup:e.target.group,TargetDimension:e.source.targetDim,SourceDimension:e.target.sourceDim})}).style("opacity",se).on("mousemove",()=>{d.updatePosition()}).on("mouseout",()=>{d.hide()}),M=O.append("g").attr("class","nodes").selectAll("path").data(r.nodes).enter().append("path").attr("d",_t.type(Ve==="circle"?Xt:Qt).size(e=>wt(e[W]))).style("opacity",Re).attr("fill",e=>{if(e.url!="noUrl")return`url(#img${e.name.replace(/\s/g,"").toLowerCase()})`;if(j){for(var n=0;n<_.length;n++)if(_[n].fieldName==e.name||_[n].fieldName==e.group)return _[n].color}else if(e.name)return i(e.name)}).attr("id",e=>e.name).attr("class",e=>"node-"+e.id).attr("stroke",e=>{if(j){for(var n=0;n<_.length;n++)if(_[n].fieldName==e.name||_[n].fieldName==e.group)return _[n].color;return"#999"}else return i(e.group)}).attr("stroke-width",e=>e.type==="source"?we==="iconNoBorder"?0:re:ke==="iconNoBorder"?0:re).attr("stroke-opacity",ht).classed("focus",e=>e.name===Ge).call(Kt().on("start",$t).on("drag",Bt).on("end",zt)).on("click",Mt).on("mouseover",e=>{d.show(l.tooltips.node.content||l.tooltips.node,{Name:e.name.bold(),Dimension:e.groupDim,Group:e.group.bold(),MeasureName:y,Value:e.fromValue===0?Q(e.toValue).bold():Q(e.fromValue).bold(),Color:e.group.bold(),ImageURL:e.url.bold()},e.fixed?"&#128204 Right click to unpin":null)}).on("mousemove",()=>{d.updatePosition()}).on("mouseout",()=>{d.hide()}).on("contextmenu",function(e,n){if(Z=1,R.preventDefault(),e.fixed=!1,e.fx=null,e.fy=null,l.enableValueStoreParameter)try{setTimeout(function(){rt.debounce(nt(oe),3e3)},700)}catch{}}),fe=O.append("g").attr("class","labelNodes").selectAll("text").data(r.nodes).enter().append("text").attr("dx",0).attr("dy",".35em").text(e=>e.name).style("display",ue==="always"?"block":"none").style("fill",gt).style("font-size",L*.3+"rem").style("text-anchor","middle").style("pointer-events","none"),Vt=ot(".container"),Ae=en().x(function(e){return e[0]}).y(function(e){return e[1]}).curve(rn),Ct=u/2-u/2*ve,St=f/2-f/2*ve;var Qe=Rt.translate(Ct,St).scale(ve);function Nt(){let{x:e,y:n,k:o}=R.transform;Vt.attr("transform",`translate(${e},${n}) scale(${o})`)}var Me=jt().scaleExtent([-10,10]).on("zoom",Nt);t.call(Me).call(Me.transform,Qe),t.on("dblclick.zoom",null);function Lt(){Me.transform(t,Qe)}t.append("g").attr("class","reset").append("circle").attr("cx",u-30).attr("cy",30).attr("r",15).attr("stroke","#eee").attr("pointer-events","all").style("cursor","pointer").attr("fill","#ffffff").attr("width",110).attr("height",20).attr("opacity",1).on("click",function(){Lt()}).on("mouseover",function(e){E(this).attr("fill","#f1f1f1")}).on("mouseout",function(e){E(this).attr("fill","#ffffff")}),t.append("g").attr("class","buttonText").append("foreignObject").attr("class","buttonText").attr("x",u-42).attr("y",19).attr("width",100).attr("height",20).style("font-color","#ddd").attr("font-weight","bold").attr("pointer-events","none").attr("dy","0.35em").append("xhtml:div").style("font","12px 'Helvetica Neue'").html('<span ><svg style="width:24px;height:24px" viewBox="0 0 24 26"><path fill="currentColor" d="M12 5.5L10 8H14L12 5.5M18 10V14L20.5 12L18 10M6 10L3.5 12L6 14V10M14 16H10L12 18.5L14 16M21 3H3C1.9 3 1 3.9 1 5V19C1 20.1 1.9 21 3 21H21C22.1 21 23 20.1 23 19V5C23 3.9 22.1 3 21 3M21 19H3V5H21V19Z" /></svg> <span> ').attr("pointer-events","none"),t.append("g").attr("class","release").append("circle").attr("fill","#ffffff").attr("cx",u-30).attr("cy",62).attr("r",15).attr("stroke","#eee").attr("fill","#f1f1f1").attr("pointer-events","all").style("cursor","pointer").attr("fill","#ffffff").attr("width",110).attr("height",20).attr("opacity",1).on("click",function(){l.enableValueStoreParameter||l.enableValueStoreSettings?(xt(),oe={},G={}):M.each(function(e){e.fixed=!1,e.fx=null,e.fy=null}),!l.enableValueStoreParameter&&!l.enableValueStoreSettings&&!$&&document.dispatchEvent(yt)}).on("mouseover",function(e){E(this).attr("fill","#f1f1f1")}).on("mouseout",function(e){E(this).attr("fill","#fff")}),t.append("g").attr("class","buttonText").append("foreignObject").attr("class","buttonText").attr("x",u-42).attr("y",50).attr("width",100).attr("height",20).style("font-color","#ddd").attr("font-weight","bold").attr("pointer-events","none").attr("dy","0.35em").append("xhtml:div").style("font","12px 'Helvetica Neue'").html('<svg style="width:24px;height:24px" viewBox="0 0 24 24"> <path fill="currentColor" d="M2,5.27L3.28,4L20,20.72L18.73,22L12.8,16.07V22H11.2V16H6V14L8,12V11.27L2,5.27M16,12L18,14V16H17.82L8,6.18V4H7V2H17V4H16V12Z" /></svg> ').attr("pointer-events","none"),mt==="1"&&(t.append("g").attr("class","release").append("circle").attr("cx",u-30).attr("cy",95).attr("r",15).attr("stroke","#eeeeee").attr("pointer-events","all").style("cursor","pointer").attr("fill","#ffffff").attr("width",110).attr("height",20).attr("opacity",1).attr("z-index",999).on("dblclick",function(){O.selectAll("g.hullGroup").remove()}).on("click",Et).on("mouseover",function(o){E(this).attr("fill","#f1f1f1")}).on("mouseout",function(o){E(this).attr("fill","#ffffff")}),t.append("g").attr("class","buttonText").append("foreignObject").attr("class","buttonText").attr("x",u-42).attr("y",83).attr("width",100).attr("height",20).style("font-color","#ddd").attr("font-weight","bold").attr("pointer-events","none").attr("dy","0.35em").append("xhtml:div").style("font","12px 'Helvetica Neue'").html('<svg style="width:24px;height:24px" viewBox="0 0 24 24"> <path fill="currentColor" d="M9,5C10.04,5 11.06,5.24 12,5.68C12.94,5.24 13.96,5 15,5A7,7 0 0,1 22,12A7,7 0 0,1 15,19C13.96,19 12.94,18.76 12,18.32C11.06,18.76 10.04,19 9,19A7,7 0 0,1 2,12A7,7 0 0,1 9,5M9,12C9,14.22 10.21,16.16 12,17.2C13.79,16.16 15,14.22 15,12C15,9.78 13.79,7.84 12,6.8C10.21,7.84 9,9.78 9,12Z"/></svg>').attr("pointer-events","none"));let de=t.append("g").attr("class","savePositions");qe&&!l.enableValueStoreParameter&&l.enableValueStoreSettings&&(de.append("circle").attr("fill","#ffffff").attr("cx",u-30).attr("cy",130).attr("r",15).attr("pointer-events","all").attr("fill","#ddd").attr("width",110).attr("height",20).attr("opacity",1).attr("z-index",999).on("dblclick",function(){O.selectAll("g.hullGroup").remove()}).on("click",Gt).on("mouseover",function(n){E(this).attr("fill",Z?"#6AFE01":"#ddd")}).on("mouseout",function(n){E(this).attr("fill",Z?"#6AFE01":"#ddd")}),t.append("g").attr("class","buttonText").append("foreignObject").attr("class","buttonText").attr("x",u-42).attr("y",118).attr("width",100).attr("height",20).style("font-color","#ddd").attr("font-weight","bold").attr("pointer-events","none").attr("dy","0.35em").append("xhtml:div").style("font","12px 'Helvetica Neue'").html('<svg style="width:24px;height:24px" viewBox="0 0 24 24"><path fill="currentColor" d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z" /></svg>').attr("pointer-events","none")),t.append("g").attr("class","notification").append("foreignObject").attr("class","notification");var Pe=[];r.links.forEach(function(e){Pe[e.source.index+"-"+e.target.index]=!0,Pe[e.target.index+"-"+e.source.index]=!0}),E("#searchField").style("display","block").on("keyup",At);function At(){let e=E("#searchField").node().value.toLowerCase(),n=new Set;R.stopPropagation(),K.style("opacity",o=>(o.target.name.toLowerCase().includes(e)&&(n.add(o.target.name),n.add(o.source.name)),o.source.name.toLowerCase().includes(e)&&(n.add(o.target.name),n.add(o.source.name)),o.source.name.toLowerCase().includes(e)||o.target.name.toLowerCase().includes(e)?1:.1)),M.style("opacity",function(o){return n.has(o.name)?1:.2})}function he(e,n){return e==n||Pe[e+"-"+n]}document.addEventListener("customEvent",function(e){et(),B=e.detail.highlightDirection,Se=e.detail.highlightDepth});function Mt(e){R.stopPropagation();let n=E(this);if(n.classed("focus"))return;Ge=N,n.classed("focus",!0);let p=N,b=new Set,P=Se,k=!1;if(N.length===0&&(k=!0,p=l.dimensions.length>3?[l.dimensions[0],l.dimensions[3]]:[l.dimensions[0],l.dimensions[1]]),k?e.type==="source"?Ie(p[0],e.name):Ie(p[1],e.name):p.forEach(function(s){if(s.toLowerCase()===e.type){let S=e[s.toLowerCase()+"Dim"];Ie(S,e.name)}}),P<.9){if(M.style("opacity",function(s){return he(e.index,s.index)?1:.1}),ue==="selected"&&fe.style("display",function(s){return he(e.index,s.index)?"block":"none"}),K.style("opacity",function(s){return s.source.index===e.index||s.target.index===e.index?1:.1}),je==="onClick"){var c=M.filter(s=>he(e.index,s.index)).data().map(function(s){return[s.x,s.y]}),V=te(c),C=ye(V);if(c.length>1)var V=te(c);else{var V=c;c=[1,1]}c===null||c.length,Ke(C,V,e)}}else{let s=new Set,S=new Set,H=new Set,F=new Set,ee=new Set,me=e;for(b.clear(),s.clear(),R.stopPropagation(),b.clear(),b.add(me.index),P;P>=1;P--)b.forEach(function(h){for(const g of r.links)B==="highlightOutward"?g.source.index===h&&s.add(g.source.index):B==="highlightInward"?g.target.index===h&&s.add(g.target.index):B==="highlightBoth"?(g.source.index===h||g.target.index===h)&&s.add(g.target.index):B==="highlightAll"&&P===Se&&(g.target.index===h&&S.add(g.source.index),g.source.index===h&&H.add(g.target.index))}),B!=="highlightAll"?s.forEach(function(h){for(const g of r.links)B==="highlightOutward"?g.source.index===h&&b.add(g.target.index):B==="highlightInward"?g.target.index===h&&b.add(g.source.index):B==="highlightBoth"&&(g.source.index===h||g.target.index===h)&&(b.add(g.source.index),b.add(g.target.index))}):(S.forEach(function(h){for(const g of r.links)g.target.index===h&&F.add(g.source.index)}),H.forEach(function(h){for(const g of r.links)g.source.index===h&&ee.add(g.target.index)})),F.forEach(function(h){for(const g of r.links)B==="highlightOutward"&&g.source.index===h&&S.add(g.source.index)}),ee.forEach(function(h){for(const g of r.links)B==="highlightInward"&&g.target.index===h&&H.add(g.target.index)});if(S.forEach(function(h){b.add(h)}),F.forEach(function(h){b.add(h)}),H.forEach(function(h){b.add(h)}),ee.forEach(function(h){b.add(h)}),M.style("opacity",function(h){return b.has(h.index)?1:.1}),ue==="selected"&&fe.style("display",function(h){return he(e.index,h.index)?"block":"none"}),K.style("opacity",function(h){return b.has(h.source.index)&&b.has(h.target.index)?1:.1}),je==="onClick"){var c=M.filter(function(ge){return b.has(ge.index)}).data().map(function(ge){return[ge.x,ge.y]}),V=te(c);if(V){var C=ye(V);if(c.length>1)var V=te(c);else c=[1,1];c.length,Ke(C,V,e)}}}}function Ke(e,n,o,p,b){O.selectAll("g.hull").remove(),Xe.append("g").attr("id","hull"+o.index).attr("pointer-events","all").on("click",function(){}).attr("class","hull").attr("transform",`translate(${e[0]},${e[1]}) scale(${Ce})`).append("path").transition().duration(500).attr("id","hull"+o.index).transition().duration(500).attr("opacity",1).attr("d",k=>Ae(n.map(function(c){return[c[0]-e[0],c[1]-e[1]]}))).attr("opacity",.5).attr("stroke",k=>{if(q==="nodesAndLinks")if(j){for(var c=0;c<_.length;c++)if(_[c].fieldName==o.group)return _[c].color;return"#999"}else return i(o.source.group);else return"#999"}).attr("stroke-opacity",1).attr("fill","none").attr("stroke-width",1)}function et(){O.selectAll("g.hull").remove(),K.style("opacity",se),Pt()}function Pt(){return ot(".focus").classed("focus",!1),ue==="selected"&&fe.style("display","none"),M.style("opacity",Re),K.style("opacity",se),Ge=null,qt()}function pe(){M.call(It),Ht(),K.call(Tt),fe.each(function(e){var n=M._groups[0],o=n.find(function(p){return p.__data__.name===e.name});if(o!=null){var o=o.getAttribute("d");o=o.split(","),Ve==="circle"?o=o[o.length-2]:(o=Math.abs(o[o.length-1].split("h")[0]),o=Math.sqrt(o*o+o*o))}this.setAttribute("transform",`translate(${e.x},${e.y+parseInt(o)+parseInt(re)+parseInt(pt)})`)})}function Tt(e){e.attr("d",function(n){let o=n.target.x-n.source.x,p=n.target.y-n.source.y,b=Math.sqrt(o*o+p*p);return`M${n.source.x},${n.source.y} A${b},${b} 0 0,1 ${n.target.x},${n.target.y}`}),e.attr("d",function(n){let o=n.source.x,p=n.source.y,b=n.target.x,P=n.target.y,k=E(`.node-${n.target.id}`).node(),c="";if(k!=null&&(k=k.getAttribute("d").split(","),Ve==="circle"?(c=k[k.length-2],c=Math.abs(c)):(c=Math.abs(k[k.length-1].split("h")[0]),c=Math.sqrt(c*c+c*c)),!isNaN(c))){let S=D?parseInt(c)+parseInt(re):0;if(U){let H=this.getTotalLength(),F=this.getPointAtLength(H-S),ee=F.x-o,me=F.y-p,h=Math.sqrt(ee*ee+me*me);return`M${o},${p}A${h},${h} 0 0,1 ${F.x},${F.y}`}else{let H=b-o,F=P-p;var V=Math.atan2(F,H),C=b-Math.cos(V)*S,s=P-Math.sin(V)*S;return`M${o},${p} ${C},${s}`}}})}function It(e){e.attr("transform",n=>`translate(${n.x},${n.y})`)}let Te=!1;function Et(){if(Te)O.selectAll("g.hullGroup").remove(),Te=!1;else{Te=!0,tt(),O.selectAll("g.hullGroup").remove();let e=new Set;r.nodes.forEach(function(n){e.add(n.groupId)}),e.forEach(function(n){tt();let o=new Set,p=r.links.filter(function(s){return n==s.group}).map(function(s){return o.add(s.target.name),[s.target.x,s.target.y]}),b=r.links.filter(function(s){return n==s.group}).map(function(s){return o.add(s.source.name),[s.source.x,s.source.y]});p.push(...b);var P=te(p);let k=o.size-1,c=ye(P);var V=n,C=Xe.append("g").attr("class","hullGroup").attr("id",`hull-${V}`).attr("pointer-events","all").on("mouseover",function(){let s=`Group ${V} has ${k} nodes`;d.show(l.tooltips,null,s)}).on("contextmenu",function(s,S){R.preventDefault(),M.filter(function(H){return n==H.group}).each(function(H){H.fx=null,H.fy=null})}).on("mouseout",function(){d.hide()}).on("mousemove",()=>{d.updatePosition()}).attr("transform",`translate(${c[0]},${c[1]}) scale(${Ce})`);C.append("path").transition().duration(700).attr("id",`hullPath-${V}`).attr("d",s=>Ae(P.map(function(S){return[S[0]-c[0],S[1]-c[1]]}))).attr("fill",s=>{for(var S=0;S<_.length;S++)if(_[S].fieldName==n)return _[S].color}).attr("opacity",.5)})}}function Ht(e){try{let n=new Set;r.nodes.forEach(function(o){n.add(o.groupId)}),n.forEach(function(o){let p=r.links.filter(function(C){return o==C.group}).map(function(C){return[C.target.x,C.target.y]}),b=r.links.filter(function(C){return o==C.group}).map(function(C){return[C.source.x,C.source.y]});p.push(...b);var P=te(p);let k=ye(P);var c=o;let V=E(`#hull-${c}`);V.attr(`translate(${k[0]},${k[1]}) scale(${Ce})`),V.select("path").attr("d",C=>Ae(P.map(function(s){return[s[0]-k[0],s[1]-k[1]]}))).attr("fill",C=>{for(var s=0;s<_.length;s++)if(_[s].fieldName==o)return _[s].color;return"#eee"}).attr("opacity",.5)})}catch{}}function $t(e){R.active||z.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function Bt(e){d.updatePosition(),e.fx=R.x,e.fy=R.y}let oe={};function zt(e){if(z.alphaTarget(0),R.active||z.alphaTarget(0),e.fixed=!0,M.each(function(n){n.fx!==void 0&&n.fx!==null&&(oe[n.name]={x:n.fx,y:n.fy})}),Z=1,de.selectAll("circle").attr("fill","#79FE01"),l.enableValueStoreParameter)try{setTimeout(function(){rt.debounce(nt(oe),3e3)},700)}catch{}}function tt(){for(var e=0;e<dt-1;++e)z.tick();pe()}Ot();function Ot(){try{if(Object.keys(G).length===0){if(l.enableValueStoreParameter&&!l.enableValueStoreSettings)M.each(function(e){G[e.name]!=null&&(e.fx=G[e.name].x,e.fy=G[e.name].y)});else if(l.enableValueStoreSettings&&!l.enableValueStoreParameter){let e=l.nodePositions===null?{}:JSON.parse(l.nodePositions);e!=null&&M.each(function(n){e[n.name]!=null&&(n.fx=e[n.name].x,n.fy=e[n.name].y)})}}else M.each(function(e){G[e.name]!=null&&(e.fx=G[e.name].x,e.fy=G[e.name].y)})}catch{}}function nt(e){l.enableValueStoreParameter&&(He()?window.tableau.extensions.worksheetContent.worksheet:window.tableau.extensions.dashboardContent.dashboard).findParameterAsync(l.localViewParameter).then(function(o){o.changeValueAsync(JSON.stringify(e))})}function Dt(e){(He()?window.tableau.extensions.worksheetContent.worksheet:window.tableau.extensions.dashboardContent.dashboard).findParameterAsync(l.localViewParameter).then(function(o){o.changeValueAsync(JSON.stringify({}))})}function Gt(){Z===1&&(Z=0,de.selectAll("circle").attr("fill","#ddd"),l.enableValueStoreSettings&&(le.settings.set("nodePositions",JSON.stringify(oe)),le.settings.saveAsync()))}function Ft(){Z===1&&(Z=0,de.selectAll("circle").attr("fill","#ddd"),l.enableValueStoreSettings&&(le.settings.set("nodePositions",JSON.stringify({})),le.settings.saveAsync()))}}export{Pn as draw,Mn as parse};
//# sourceMappingURL=network-diagram-2.0-CWZN5Sn4.js.map
