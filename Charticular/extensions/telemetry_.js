!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.CharticulatorTelemetry=n():t.CharticulatorTelemetry=n()}(window,function(){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const o=e(1),i=!0;t.exports=class{constructor(t){this.instrumentationKey=t}activate(t){if(this.instrumentationKey){t&&i&&(o.AppInsights.downloadAndSetup({instrumentationKey:this.instrumentationKey}),o.AppInsights.trackPageView()),this.context=t;const n=this.context.getGlobalDispatcher();this.dispatcherID=n.register(this.handleAction.bind(this),0)}else console.error("Instrumentation Key Required!")}getExportMetadata(t){const n=this.context.app,e=n&&n.mainStore,o=e&&e.chartStore,i=o&&o.chartManager;if(i){const t={};for(const n of Charticulator.Core.Prototypes.ObjectClasses.RegisteredClasses())t[n.classID]=0;return i.enumerateClasses(n=>{let e=n.object&&n.object.classID;e||(e=n.constructor&&n.constructor.classID),t[e||"Unknown"]=(t[e||"Unknown"]||0)+1}),{types:t}}return{error:"Could not find chart manager"}}generateSummaryStatistics(t){const n={};if(t&&t.rows&&t.rows.length&&t.columns&&t.columns.length){const e=t.columns.map(t=>t.name);t.rows.forEach((o,i)=>{e.forEach((e,s)=>{const a=o[e],r=t.columns[s];if("number"===r.type)if(0===i)n[e]={sum:a,min:a,max:a};else{const t=n[e];t.sum+=a,a<t.min?t.min=a:a>t.max&&(t.max=a)}else if("date"===r.type)if(0===i)n[e]={start:a,end:a};else{const t=n[e];a<t.start?t.start=a:a>t.end&&(t.end=a)}else if("string"===r.type&&r.metadata&&"categorical"===r.metadata.kind)if(0===i)n[e]={uniqueCount:1,__NO_UPLOAD__categoryExists:{[a]:!0}};else{const t=n[e];t.__NO_UPLOAD__categoryExists[a]||(t.uniqueCount++,t.__NO_UPLOAD__categoryExists[a]=!0)}})}),Object.keys(n).forEach(e=>{const o=n[e];o.hasOwnProperty("sum")&&(o.avg=o.sum/t.rows.length),Object.keys(o).forEach(t=>{t.indexOf("__NO_UPLOAD__")>=0&&delete o[t]})})}return n}handleAction(t){try{if(this.context&&i){t instanceof Charticulator.Actions.Open?this.trackEvent("open"):t instanceof Charticulator.Actions.Save?this.trackEvent("save"):t instanceof Charticulator.Actions.SaveAs&&this.trackEvent("saveas");{const n=n=>{const e=t&&t.digest(),o=e&&e.name||"Unknown",i=n||"";this.trackEvent("interaction",{type:o,target:i})};t.object?n(t.object&&t.object.classID):t.chartElement?n(t.chartElement&&t.chartElement.classID):t.plotSegment&&n(t.plotSegment&&t.plotSegment.classID),t.mark&&n(t.mark&&t.mark.classID),t.glyph&&n(t.glyph&&t.glyph.classID),n()}{const n=this.getExportMetadata(t);t instanceof Charticulator.Actions.ExportTemplate?this.trackEvent("export-template",Object.assign({kind:t.kind},n)):t instanceof Charticulator.Actions.Export&&this.trackEvent("export",Object.assign({type:t.type},n))}if(t instanceof Charticulator.Actions.ImportDataset){const{dataset:n}=t||{},e={};n&&n.tables&&n.tables.length&&(e.tables=n.tables.map(t=>({"rows.count":t.rows.length,"columns.count":t.columns.length,columns:t.columns.map(t=>({type:t.type,metadata:{kind:(t.metadata||{}).kind}}))})),e["tables.count"]=e.tables.length),this.trackEvent("import-dataset",Object.assign({},e))}}}catch(t){console.error(t)}}trackEvent(t,n){t&&o.AppInsights.trackEvent(t,n?function(t){const n={};return function t(e,o){if(Object(e)!==e)n[o]=e;else if(Array.isArray(e)){const i=e.length;for(let n=0;n<i;n++)t(e[n],o+"["+n+"]");0==i&&(n[o]=[])}else{let i=!0;for(const n in e)i=!1,t(e[n],o?o+"."+n:n);i&&o&&(n[o]={})}}(t,""),n}(n):void 0)}}},function(t,n,e){"use strict";var o,i,s;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(s||(s={})),function(t){!function(t){var n=function(){return function(){}}();t.Base=n}(t.Telemetry||(t.Telemetry={}))}(s||(s={})),function(t){!function(t){var n=function(){return function(){this.ver=1,this.sampleRate=100,this.tags={}}}();t.Envelope=n}(t.Telemetry||(t.Telemetry={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(s||(s={})),function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(s||(s={})),function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(s||(s={})),function(t){!function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"}(t.SeverityLevel||(t.SeverityLevel={}))}(i||(i={})),function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(s||(s={})),function(t){!function(t){var n=function(){function t(){}return t.newId=function(){for(var t="",n=1073741824*Math.random();n>0;){t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n%64),n=Math.floor(n/64)}return t},t}();t.UtilHelpers=n}(t.ApplicationInsights||(t.ApplicationInsights={}))}(s||(s={})),void 0===(o=function(t,n){Object.defineProperty(n,"__esModule",{value:!0});var e=function(){function t(){}return t._createLazyMethod=function(n){var e=window[t.appInsightsName];e[n]=function(){var t=arguments;e.queue?e.queue.push(function(){return e[n].apply(e,t)}):e[n].apply(e,t)}},t._defineLazyMethods=function(){var n=window[t.appInsightsName];try{n.cookie=document.cookie}catch(t){}n.queue=[];for(var e=["clearAuthenticatedUserContext","flush","setAuthenticatedUserContext","startTrackEvent","startTrackPage","stopTrackEvent","stopTrackPage","trackDependency","trackEvent","trackException","trackMetric","trackPageView","trackTrace"];e.length;)t._createLazyMethod(e.pop())},t._download=function(n){t.appInsightsInstance.config=n;var e=window[t.appInsightsName];if(e.queue||(e.queue=[]),setTimeout(function(){var t=document.createElement("script");t.src=n.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",document.head.appendChild(t)}),!n.disableExceptionTracking){t._createLazyMethod("_onerror");var o=window.onerror;window.onerror=function(t,n,i,s,a){var r=o&&o(t,n,i,s,a);return!0!==r&&e._onerror(t,n,i,s,a),r}}},Object.defineProperty(t,"appInsightsInstance",{get:function(){if("undefined"!=typeof window)return window[t.appInsightsName]||(window[t.appInsightsName]={downloadAndSetup:t._download,_defineLazyMethods:t._defineLazyMethods},t._defineLazyMethods()),window[t.appInsightsName]},enumerable:!0,configurable:!0}),t.appInsightsInitialized=!1,t.appInsightsName="appInsights",t}();n.AppInsights=e.appInsightsInstance}.apply(n,[e,n]))||(t.exports=o)}])});